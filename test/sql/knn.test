# name: test/sql/knn.test
# description: Minimal KNN API surface tests for lance_knn
# group: [sql]

require lance

# Invalid dataset root
statement error
SELECT * FROM lance_knn('dummy_path.lance', 'vec', [1.0], 1)
----
IO Error: Failed to open Lance dataset: dummy_path.lance (Lance error: dataset open 'dummy_path.lance':

# Empty query vector is rejected
statement error
SELECT * FROM lance_knn('test/test_data.lance', 'vec', []::FLOAT[], 1)
----
Invalid Input Error: lance_knn requires a non-empty query vector

# Non-positive k is rejected
statement error
SELECT * FROM lance_knn('test/test_data.lance', 'vec', [1.0], 0)
----
Invalid Input Error: lance_knn requires k > 0

